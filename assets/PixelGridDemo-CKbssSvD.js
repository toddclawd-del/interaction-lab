import{j as e}from"./three-vendor-CgYOwSjb.js";import{r as n}from"./react-vendor-DtyY8K5c.js";function de(y){const{width:v,height:g,pixelSize:l,gap:i}=y,d=l+i,f=Math.ceil(v/d),t=Math.ceil(g/d),o=t*f,r=[];for(let s=0;s<t;s++)for(let u=0;u<f;u++){const h=s*f+u;r.push({x:u*d+l/2,y:s*d+l/2,index:h})}return{rows:t,cols:f,totalPixels:o,pixelPositions:r}}function ue(y,v,g="top"){const{rows:l,cols:i,pixelPositions:d}=y,f=(i-1)/2,t=(l-1)/2;switch(v){case"radial":return[...d].sort((r,s)=>{const u=Math.hypot(r.x-f*10,r.y-t*10),h=Math.hypot(s.x-f*10,s.y-t*10);return u-h}).map(r=>r.index);case"directional":return[...d].sort((r,s)=>{switch(g){case"top":return r.y-s.y;case"bottom":return s.y-r.y;case"left":return r.x-s.x;case"right":return s.x-r.x}}).map(r=>r.index);case"random":{const o=d.map(r=>r.index);for(let r=o.length-1;r>0;r--){const s=Math.floor(Math.random()*(r+1));[o[r],o[s]]=[o[s],o[r]]}return o}case"typewriter":return d.map(o=>o.index);default:return d.map(o=>o.index)}}function he(y,v,g,l,i,d,f){if(f==="none")return{offsetX:0,offsetY:0};const t=y-g,o=v-l,r=Math.hypot(t,o);if(r>i)return{offsetX:0,offsetY:0};const s=Math.pow(1-r/i,2),u=r>0?t/r:0,h=r>0?o/r:0;let k=0,C=0;switch(f){case"repel":k=u*d*s*10,C=h*d*s*10;break;case"attract":k=-u*d*s*10,C=-h*d*s*10;break;case"swirl":const P=s*d*.5,S=Math.cos(P),$=Math.sin(P);k=(t*S-o*$-t)*s,C=(t*$+o*S-o)*s;break}return{offsetX:k,offsetY:C}}function b({children:y,src:v,text:g,pixelSize:l=8,gap:i=2,shape:d="square",borderRadius:f=0,animationSpeed:t=1,revealPattern:o="radial",revealDirection:r="top",staggerDelay:s=20,interactive:u=!0,distortionMode:h="repel",distortionStrength:k=3,distortionRadius:C=80,triggerOnView:P=!0,triggerThreshold:S=.3,autoPlay:$=!1,delay:Y=0,backgroundColor:H="#000",pixelColor:V="#1a1a1a",className:K="",onRevealStart:L,onRevealComplete:M}){const j=n.useRef(null),_=n.useRef(null),q=n.useRef([]),E=n.useRef({x:0,y:0,active:!1}),O=n.useRef(),[D,J]=n.useState({width:0,height:0}),[p,U]=n.useState(!1),[w,z]=n.useState(!1),T=n.useMemo(()=>typeof window>"u"?!1:window.matchMedia("(prefers-reduced-motion: reduce)").matches,[]),m=n.useMemo(()=>D.width===0||D.height===0?null:de({width:D.width,height:D.height,pixelSize:l,gap:i}),[D,l,i]),F=n.useMemo(()=>m?ue(m,o,r):[],[m,o,r]);n.useEffect(()=>{if(!j.current)return;const a=new ResizeObserver(c=>{const x=c[0];x&&J({width:x.contentRect.width,height:x.contentRect.height})});return a.observe(j.current),()=>a.disconnect()},[]),n.useEffect(()=>{if(!P||!j.current||p||$)return;const a=new IntersectionObserver(([c])=>{c.isIntersecting&&(setTimeout(()=>N(),Y),a.disconnect())},{threshold:S});return a.observe(j.current),()=>a.disconnect()},[P,S,p,$,Y]),n.useEffect(()=>{$&&m&&!p&&setTimeout(()=>N(),Y)},[$,m,Y]);const N=n.useCallback(()=>{if(w||p)return;if(z(!0),L==null||L(),T){U(!0),z(!1),M==null||M();return}const a=300/t,c=s/t;F.forEach((B,R)=>{const I=q.current[B];if(!I)return;const G=R*c;setTimeout(()=>{I.classList.add("pixel-revealed")},G)});const x=F.length*c+a;setTimeout(()=>{U(!0),z(!1),M==null||M()},x)},[w,p,F,t,s,T,L,M]),Z=n.useCallback(a=>{if(!u||h==="none"||!j.current)return;const c=j.current.getBoundingClientRect();E.current={x:a.clientX-c.left,y:a.clientY-c.top,active:!0}},[u,h]),ee=n.useCallback(()=>{E.current.active=!1},[]),te=n.useCallback(a=>{if(!u||h==="none"||!j.current)return;const c=a.touches[0];if(!c)return;const x=j.current.getBoundingClientRect();E.current={x:c.clientX-x.left,y:c.clientY-x.top,active:!0}},[u,h]),re=n.useCallback(a=>{if(!u||h==="none"||!j.current)return;const c=a.touches[0];if(!c)return;const x=j.current.getBoundingClientRect();E.current={x:c.clientX-x.left,y:c.clientY-x.top,active:!0},!p&&!w&&N()},[u,h,p,w,N]),se=n.useCallback(()=>{E.current.active=!1},[]);n.useEffect(()=>{if(!u||h==="none"||T)return;const a=()=>{const{x:c,y:x,active:B}=E.current;q.current.forEach((R,I)=>{if(!R||!m)return;const G=Math.floor(I/m.cols),ce=I%m.cols*(l+i)+l/2,le=G*(l+i)+l/2;if(B){const{offsetX:X,offsetY:A}=he(ce,le,c,x,C,k,h);R.style.transform=`translate(${X}px, ${A}px)`}else{const X=R.style.transform;if(X&&X!=="translate(0px, 0px)"){const A=X.match(/translate\(([-\d.]+)px,\s*([-\d.]+)px\)/);if(A){const W=parseFloat(A[1])*.9,Q=parseFloat(A[2])*.9;Math.abs(W)<.1&&Math.abs(Q)<.1?R.style.transform="":R.style.transform=`translate(${W}px, ${Q}px)`}}}}),O.current=requestAnimationFrame(a)};return O.current=requestAnimationFrame(a),()=>{O.current&&cancelAnimationFrame(O.current)}},[u,h,C,k,m,l,i,T]);const ne=n.useCallback(()=>{!p&&!w&&N()},[p,w,N]),ie=n.useCallback(a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),!p&&!w&&N())},[p,w,N]);if(!m)return e.jsx("div",{ref:j,className:`pixel-grid-container ${K}`,style:{backgroundColor:H},children:y});const oe=m.rows*m.cols,ae={"--pixel-size":`${l}px`,"--pixel-gap":`${i}px`,"--pixel-color":V,"--pixel-radius":d==="circle"?"50%":`${f}px`,"--animation-duration":`${300/t}ms`};return e.jsxs("div",{ref:j,className:`pixel-grid-container ${K}`,style:{backgroundColor:H,...ae},onMouseMove:Z,onMouseLeave:ee,onTouchMove:te,onTouchStart:re,onTouchEnd:se,onFocus:ne,onKeyDown:ie,tabIndex:0,role:"img","aria-busy":w,"aria-live":"polite","aria-label":g||"Pixel grid reveal animation",children:[e.jsx("div",{ref:_,className:"pixel-grid-content","aria-hidden":!p,children:g?e.jsx("span",{className:"pixel-grid-text",children:g}):v?e.jsx("img",{src:v,alt:"",className:"pixel-grid-image"}):y}),e.jsx("div",{className:"pixel-grid-overlay",style:{gridTemplateColumns:`repeat(${m.cols}, ${l}px)`,gridTemplateRows:`repeat(${m.rows}, ${l}px)`,gap:`${i}px`},"aria-hidden":"true",children:Array.from({length:oe}).map((a,c)=>e.jsx("div",{ref:x=>{x&&(q.current[c]=x)},className:`pixel ${T||p?"pixel-revealed":""}`},c))})]})}function ge(){const[y,v]=n.useState("radial"),[g,l]=n.useState("repel"),[i,d]=n.useState(0),f=()=>d(t=>t+1);return e.jsxs("div",{className:"pixel-grid-demo",children:[e.jsx("h1",{children:"Pixel Grid Reveal"}),e.jsx("a",{href:"#/",children:"← Back to Home"}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Text Reveal"}),e.jsx("p",{children:"Scroll into view or click to trigger. Move mouse for distortion."}),e.jsx("div",{className:"demo-card",style:{height:300},children:e.jsx(b,{text:"PIXELS",pixelSize:6,gap:2,revealPattern:"radial",distortionMode:"repel",backgroundColor:"#0a0a0a",pixelColor:"#1a1a1a"},`text-${i}`)}),e.jsx("button",{style:{marginTop:"1rem",padding:"0.5rem 1rem",cursor:"pointer"},onClick:f,children:"Reset All"})]}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Reveal Patterns"}),e.jsx("div",{className:"demo-controls",children:["radial","directional","random","typewriter"].map(t=>e.jsx("button",{className:y===t?"active":"",onClick:()=>{v(t),f()},children:t},t))}),e.jsx("div",{className:"demo-card",style:{height:250},children:e.jsx(b,{text:"HELLO",pixelSize:8,gap:2,revealPattern:y,revealDirection:"left",interactive:!1,autoPlay:!0,delay:300,backgroundColor:"#111",pixelColor:"#222"},`pattern-${y}-${i}`)})]}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Distortion Modes"}),e.jsx("p",{children:"Tap the grid or move your finger for distortion."}),e.jsx("div",{className:"demo-controls",children:["repel","attract","swirl","none"].map(t=>e.jsx("button",{className:g===t?"active":"",onClick:()=>l(t),children:t},t))}),e.jsxs("div",{className:"demo-grid demo-grid-2col",children:[e.jsx("div",{className:"demo-card",style:{height:200,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:e.jsx(b,{pixelSize:10,gap:3,shape:"circle",distortionMode:g,distortionStrength:5,distortionRadius:100,autoPlay:!0,delay:200,backgroundColor:"transparent",pixelColor:"#000",children:e.jsx("div",{style:{width:"100%",height:"100%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.5rem",fontWeight:"bold"},children:"CONTENT"})},`distort-${i}`)}),e.jsx("div",{className:"demo-card",style:{height:200},children:e.jsx(b,{pixelSize:6,gap:1,shape:"square",borderRadius:2,distortionMode:g,distortionStrength:3,distortionRadius:80,autoPlay:!0,delay:400,backgroundColor:"#0a0a0a",pixelColor:"#1a1a1a",children:e.jsx("div",{style:{width:"100%",height:"100%",background:"linear-gradient(to right, #00c6ff, #0072ff)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.5rem",fontWeight:"bold"},children:"HOVER ME"})},`distort2-${i}`)})]})]}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Pixel Size Comparison"}),e.jsx("div",{className:"demo-grid demo-grid-3col",children:[4,8,16].map(t=>e.jsx("div",{className:"demo-card",style:{height:150},children:e.jsx(b,{text:`${t}px`,pixelSize:t,gap:t/4,autoPlay:!0,delay:t*50,staggerDelay:t<8?5:15,backgroundColor:"#111",pixelColor:"#222"},`size-${t}-${i}`)},t))})]}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Pixel Shapes"}),e.jsxs("div",{className:"demo-grid demo-grid-3col",children:[e.jsx("div",{className:"demo-card",style:{height:150},children:e.jsx(b,{text:"SQUARE",pixelSize:8,gap:2,shape:"square",autoPlay:!0,delay:100,backgroundColor:"#111",pixelColor:"#222"},`shape-square-${i}`)}),e.jsx("div",{className:"demo-card",style:{height:150},children:e.jsx(b,{text:"ROUNDED",pixelSize:8,gap:2,shape:"square",borderRadius:3,autoPlay:!0,delay:200,backgroundColor:"#111",pixelColor:"#222"},`shape-rounded-${i}`)}),e.jsx("div",{className:"demo-card",style:{height:150},children:e.jsx(b,{text:"CIRCLE",pixelSize:8,gap:2,shape:"circle",autoPlay:!0,delay:300,backgroundColor:"#111",pixelColor:"#222"},`shape-circle-${i}`)})]})]}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Animation Speeds"}),e.jsx("div",{className:"demo-grid demo-grid-3col",children:[.5,1,2].map(t=>e.jsx("div",{className:"demo-card",style:{height:150},children:e.jsx(b,{text:`${t}x`,pixelSize:8,gap:2,animationSpeed:t,autoPlay:!0,delay:500,backgroundColor:"#111",pixelColor:"#222"},`speed-${t}-${i}`)},t))})]}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Hero Section Use Case"}),e.jsx("div",{style:{height:400,borderRadius:12,overflow:"hidden"},children:e.jsx(b,{pixelSize:12,gap:3,revealPattern:"radial",distortionMode:"repel",distortionStrength:4,distortionRadius:120,staggerDelay:8,triggerOnView:!0,backgroundColor:"#000",pixelColor:"#111",children:e.jsxs("div",{style:{width:"100%",height:"100%",background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"white",gap:"1rem"},children:[e.jsx("h2",{style:{fontSize:"3rem",fontWeight:800,margin:0},children:"PIXEL GRID"}),e.jsx("p",{style:{fontSize:"1.25rem",opacity:.7,margin:0},children:"Interactive reveal component"})]})},`hero-${i}`)})]}),e.jsxs("section",{className:"demo-section",style:{marginBottom:"8rem"},children:[e.jsx("h2",{children:"Accessibility"}),e.jsxs("ul",{style:{color:"#888",lineHeight:1.8},children:[e.jsx("li",{children:"Tab to focus any grid — Enter/Space triggers reveal"}),e.jsx("li",{children:"Reduced motion: animations skip, content shows immediately"}),e.jsx("li",{children:"Screen readers: aria-busy during animation, aria-live for state changes"}),e.jsx("li",{children:"Keyboard-navigable with visible focus ring"})]})]})]})}export{ge as PixelGridDemo,ge as default};
