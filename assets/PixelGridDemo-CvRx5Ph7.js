import{j as e}from"./three-vendor-CgYOwSjb.js";import{r as o}from"./react-vendor-DtyY8K5c.js";function ae(f){const{width:y,height:d,pixelSize:a,gap:i}=f,c=a+i,u=Math.ceil(y/c),t=Math.ceil(d/c),n=t*u,r=[];for(let s=0;s<t;s++)for(let h=0;h<u;h++){const p=s*u+h;r.push({x:h*c+a/2,y:s*c+a/2,index:p})}return{rows:t,cols:u,totalPixels:n,pixelPositions:r}}function ce(f,y,d="top"){const{rows:a,cols:i,pixelPositions:c}=f,u=(i-1)/2,t=(a-1)/2;switch(y){case"radial":return[...c].sort((r,s)=>{const h=Math.hypot(r.x-u*10,r.y-t*10),p=Math.hypot(s.x-u*10,s.y-t*10);return h-p}).map(r=>r.index);case"directional":return[...c].sort((r,s)=>{switch(d){case"top":return r.y-s.y;case"bottom":return s.y-r.y;case"left":return r.x-s.x;case"right":return s.x-r.x}}).map(r=>r.index);case"random":{const n=c.map(r=>r.index);for(let r=n.length-1;r>0;r--){const s=Math.floor(Math.random()*(r+1));[n[r],n[s]]=[n[s],n[r]]}return n}case"typewriter":return c.map(n=>n.index);default:return c.map(n=>n.index)}}function le(f,y,d,a,i,c,u){if(u==="none")return{offsetX:0,offsetY:0};const t=f-d,n=y-a,r=Math.hypot(t,n);if(r>i)return{offsetX:0,offsetY:0};const s=Math.pow(1-r/i,2),h=r>0?t/r:0,p=r>0?n/r:0;let w=0,N=0;switch(u){case"repel":w=h*c*s*10,N=p*c*s*10;break;case"attract":w=-h*c*s*10,N=-p*c*s*10;break;case"swirl":const R=s*c*.5,E=Math.cos(R),$=Math.sin(R);w=(t*E-n*$-t)*s,N=(t*$+n*E-n)*s;break}return{offsetX:w,offsetY:N}}function v({children:f,src:y,text:d,pixelSize:a=8,gap:i=2,shape:c="square",borderRadius:u=0,animationSpeed:t=1,revealPattern:n="radial",revealDirection:r="top",staggerDelay:s=20,interactive:h=!0,distortionMode:p="repel",distortionStrength:w=3,distortionRadius:N=80,triggerOnView:R=!0,triggerThreshold:E=.3,autoPlay:$=!1,delay:X=0,backgroundColor:B="#000",pixelColor:V="#1a1a1a",className:K="",onRevealStart:L,onRevealComplete:C}){const b=o.useRef(null),_=o.useRef(null),Y=o.useRef([]),q=o.useRef({x:0,y:0,active:!1}),O=o.useRef(),[S,J]=o.useState({width:0,height:0}),[g,U]=o.useState(!1),[k,z]=o.useState(!1),D=o.useMemo(()=>typeof window>"u"?!1:window.matchMedia("(prefers-reduced-motion: reduce)").matches,[]),x=o.useMemo(()=>S.width===0||S.height===0?null:ae({width:S.width,height:S.height,pixelSize:a,gap:i}),[S,a,i]),F=o.useMemo(()=>x?ce(x,n,r):[],[x,n,r]);o.useEffect(()=>{if(!b.current)return;const l=new ResizeObserver(m=>{const j=m[0];j&&J({width:j.contentRect.width,height:j.contentRect.height})});return l.observe(b.current),()=>l.disconnect()},[]),o.useEffect(()=>{if(!R||!b.current||g||$)return;const l=new IntersectionObserver(([m])=>{m.isIntersecting&&(setTimeout(()=>P(),X),l.disconnect())},{threshold:E});return l.observe(b.current),()=>l.disconnect()},[R,E,g,$,X]),o.useEffect(()=>{$&&x&&!g&&setTimeout(()=>P(),X)},[$,x,X]);const P=o.useCallback(()=>{if(k||g)return;if(z(!0),L==null||L(),D){U(!0),z(!1),C==null||C();return}const l=300/t,m=s/t;F.forEach((G,M)=>{const T=Y.current[G];if(!T)return;const H=M*m;setTimeout(()=>{T.classList.add("pixel-revealed")},H)});const j=F.length*m+l;setTimeout(()=>{U(!0),z(!1),C==null||C()},j)},[k,g,F,t,s,D,L,C]),Z=o.useCallback(l=>{if(!h||p==="none"||!b.current)return;const m=b.current.getBoundingClientRect();q.current={x:l.clientX-m.left,y:l.clientY-m.top,active:!0}},[h,p]),ee=o.useCallback(()=>{q.current.active=!1},[]);o.useEffect(()=>{if(!h||p==="none"||D)return;const l=()=>{const{x:m,y:j,active:G}=q.current;Y.current.forEach((M,T)=>{if(!M||!x)return;const H=Math.floor(T/x.cols),ne=T%x.cols*(a+i)+a/2,oe=H*(a+i)+a/2;if(G){const{offsetX:I,offsetY:A}=le(ne,oe,m,j,N,w,p);M.style.transform=`translate(${I}px, ${A}px)`}else{const I=M.style.transform;if(I&&I!=="translate(0px, 0px)"){const A=I.match(/translate\(([-\d.]+)px,\s*([-\d.]+)px\)/);if(A){const W=parseFloat(A[1])*.9,Q=parseFloat(A[2])*.9;Math.abs(W)<.1&&Math.abs(Q)<.1?M.style.transform="":M.style.transform=`translate(${W}px, ${Q}px)`}}}}),O.current=requestAnimationFrame(l)};return O.current=requestAnimationFrame(l),()=>{O.current&&cancelAnimationFrame(O.current)}},[h,p,N,w,x,a,i,D]);const te=o.useCallback(()=>{!g&&!k&&P()},[g,k,P]),re=o.useCallback(l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),!g&&!k&&P())},[g,k,P]);if(!x)return e.jsx("div",{ref:b,className:`pixel-grid-container ${K}`,style:{backgroundColor:B},children:f});const se=x.rows*x.cols,ie={"--pixel-size":`${a}px`,"--pixel-gap":`${i}px`,"--pixel-color":V,"--pixel-radius":c==="circle"?"50%":`${u}px`,"--animation-duration":`${300/t}ms`};return e.jsxs("div",{ref:b,className:`pixel-grid-container ${K}`,style:{backgroundColor:B,...ie},onMouseMove:Z,onMouseLeave:ee,onFocus:te,onKeyDown:re,tabIndex:0,role:"img","aria-busy":k,"aria-live":"polite","aria-label":d||"Pixel grid reveal animation",children:[e.jsx("div",{ref:_,className:"pixel-grid-content","aria-hidden":!g,children:d?e.jsx("span",{className:"pixel-grid-text",children:d}):y?e.jsx("img",{src:y,alt:"",className:"pixel-grid-image"}):f}),e.jsx("div",{className:"pixel-grid-overlay",style:{gridTemplateColumns:`repeat(${x.cols}, ${a}px)`,gridTemplateRows:`repeat(${x.rows}, ${a}px)`,gap:`${i}px`},"aria-hidden":"true",children:Array.from({length:se}).map((l,m)=>e.jsx("div",{ref:j=>{j&&(Y.current[m]=j)},className:`pixel ${D||g?"pixel-revealed":""}`},m))})]})}function xe(){const[f,y]=o.useState("radial"),[d,a]=o.useState("repel"),[i,c]=o.useState(0),u=()=>c(t=>t+1);return e.jsxs("div",{className:"pixel-grid-demo",children:[e.jsx("h1",{children:"Pixel Grid Reveal"}),e.jsx("a",{href:"#/",children:"← Back to Home"}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Text Reveal"}),e.jsx("p",{children:"Scroll into view or click to trigger. Move mouse for distortion."}),e.jsx("div",{className:"demo-card",style:{height:300},children:e.jsx(v,{text:"PIXELS",pixelSize:6,gap:2,revealPattern:"radial",distortionMode:"repel",backgroundColor:"#0a0a0a",pixelColor:"#1a1a1a"},`text-${i}`)}),e.jsx("button",{style:{marginTop:"1rem",padding:"0.5rem 1rem",cursor:"pointer"},onClick:u,children:"Reset All"})]}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Reveal Patterns"}),e.jsx("div",{className:"demo-controls",children:["radial","directional","random","typewriter"].map(t=>e.jsx("button",{className:f===t?"active":"",onClick:()=>{y(t),u()},children:t},t))}),e.jsx("div",{className:"demo-card",style:{height:250},children:e.jsx(v,{text:"HELLO",pixelSize:8,gap:2,revealPattern:f,revealDirection:"left",interactive:!1,autoPlay:!0,delay:300,backgroundColor:"#111",pixelColor:"#222"},`pattern-${f}-${i}`)})]}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Distortion Modes"}),e.jsx("p",{children:"Move your mouse over the grid after reveal."}),e.jsx("div",{className:"demo-controls",children:["repel","attract","swirl","none"].map(t=>e.jsx("button",{className:d===t?"active":"",onClick:()=>a(t),children:t},t))}),e.jsxs("div",{className:"demo-grid",style:{gridTemplateColumns:"repeat(2, 1fr)"},children:[e.jsx("div",{className:"demo-card",style:{height:200,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:e.jsx(v,{pixelSize:10,gap:3,shape:"circle",distortionMode:d,distortionStrength:5,distortionRadius:100,autoPlay:!0,delay:200,backgroundColor:"transparent",pixelColor:"#000",children:e.jsx("div",{style:{width:"100%",height:"100%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"2rem",fontWeight:"bold"},children:"CONTENT"})},`distort-${d}-${i}`)}),e.jsx("div",{className:"demo-card",style:{height:200},children:e.jsx(v,{pixelSize:6,gap:1,shape:"square",borderRadius:2,distortionMode:d,distortionStrength:3,distortionRadius:80,autoPlay:!0,delay:400,backgroundColor:"#0a0a0a",pixelColor:"#1a1a1a",children:e.jsx("div",{style:{width:"100%",height:"100%",background:"linear-gradient(to right, #00c6ff, #0072ff)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.5rem",fontWeight:"bold"},children:"HOVER ME"})},`distort2-${d}-${i}`)})]})]}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Pixel Size Comparison"}),e.jsx("div",{className:"demo-grid",style:{gridTemplateColumns:"repeat(3, 1fr)"},children:[4,8,16].map(t=>e.jsx("div",{className:"demo-card",style:{height:150},children:e.jsx(v,{text:`${t}px`,pixelSize:t,gap:t/4,autoPlay:!0,delay:t*50,staggerDelay:t<8?5:15,backgroundColor:"#111",pixelColor:"#222"},`size-${t}-${i}`)},t))})]}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Pixel Shapes"}),e.jsxs("div",{className:"demo-grid",style:{gridTemplateColumns:"repeat(3, 1fr)"},children:[e.jsx("div",{className:"demo-card",style:{height:150},children:e.jsx(v,{text:"SQUARE",pixelSize:8,gap:2,shape:"square",autoPlay:!0,delay:100,backgroundColor:"#111",pixelColor:"#222"},`shape-square-${i}`)}),e.jsx("div",{className:"demo-card",style:{height:150},children:e.jsx(v,{text:"ROUNDED",pixelSize:8,gap:2,shape:"square",borderRadius:3,autoPlay:!0,delay:200,backgroundColor:"#111",pixelColor:"#222"},`shape-rounded-${i}`)}),e.jsx("div",{className:"demo-card",style:{height:150},children:e.jsx(v,{text:"CIRCLE",pixelSize:8,gap:2,shape:"circle",autoPlay:!0,delay:300,backgroundColor:"#111",pixelColor:"#222"},`shape-circle-${i}`)})]})]}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Animation Speeds"}),e.jsx("div",{className:"demo-grid",style:{gridTemplateColumns:"repeat(3, 1fr)"},children:[.5,1,2].map(t=>e.jsx("div",{className:"demo-card",style:{height:150},children:e.jsx(v,{text:`${t}x`,pixelSize:8,gap:2,animationSpeed:t,autoPlay:!0,delay:500,backgroundColor:"#111",pixelColor:"#222"},`speed-${t}-${i}`)},t))})]}),e.jsxs("section",{className:"demo-section",children:[e.jsx("h2",{children:"Hero Section Use Case"}),e.jsx("div",{style:{height:400,borderRadius:12,overflow:"hidden"},children:e.jsx(v,{pixelSize:12,gap:3,revealPattern:"radial",distortionMode:"repel",distortionStrength:4,distortionRadius:120,staggerDelay:8,triggerOnView:!0,backgroundColor:"#000",pixelColor:"#111",children:e.jsxs("div",{style:{width:"100%",height:"100%",background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"white",gap:"1rem"},children:[e.jsx("h2",{style:{fontSize:"3rem",fontWeight:800,margin:0},children:"PIXEL GRID"}),e.jsx("p",{style:{fontSize:"1.25rem",opacity:.7,margin:0},children:"Interactive reveal component"})]})},`hero-${i}`)})]}),e.jsxs("section",{className:"demo-section",style:{marginBottom:"8rem"},children:[e.jsx("h2",{children:"Accessibility"}),e.jsxs("ul",{style:{color:"#888",lineHeight:1.8},children:[e.jsx("li",{children:"Tab to focus any grid — Enter/Space triggers reveal"}),e.jsx("li",{children:"Reduced motion: animations skip, content shows immediately"}),e.jsx("li",{children:"Screen readers: aria-busy during animation, aria-live for state changes"}),e.jsx("li",{children:"Keyboard-navigable with visible focus ring"})]})]})]})}export{xe as PixelGridDemo,xe as default};
