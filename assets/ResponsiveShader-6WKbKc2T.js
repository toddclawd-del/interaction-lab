import{r as n,j as h}from"./index-Bl0IhF4C.js";import{V as i,w as z,u as P}from"./react-three-fiber.esm-Bcdnw6si.js";const p=n.createContext({mouse:new i(.5,.5),scroll:0,isMobile:!1,isHovered:!1}),O=()=>n.useContext(p);function T(){const{gl:a,size:c}=P();return n.useEffect(()=>{a.setSize(c.width,c.height)},[a,c]),null}function X({children:a,className:c,style:S,trackMouse:m=!0,mobileInteraction:u="touch",frameloop:b="always",dpr:g=[1,2],pauseWhenHidden:w=!0,onMouseEnter:f,onMouseLeave:v}){const r=n.useRef(null),[L,d]=n.useState(new i(.5,.5)),[M,x]=n.useState(0),[o,R]=n.useState(!1),[C,E]=n.useState(!1),[j,y]=n.useState(!0);n.useEffect(()=>{R("ontouchstart"in window||navigator.maxTouchPoints>0)},[]),n.useEffect(()=>{if(!m||o)return;const e=t=>{if(!r.current)return;const s=r.current.getBoundingClientRect();d(new i((t.clientX-s.left)/s.width,1-(t.clientY-s.top)/s.height))};return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)},[m,o]),n.useEffect(()=>{if(o){if(u==="scroll"){const e=()=>{const t=window.scrollY/(document.body.scrollHeight-window.innerHeight);x(t),d(new i(.5,t))};return window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)}if(u==="touch"){const e=t=>{if(!r.current)return;const s=r.current.getBoundingClientRect(),l=t.touches[0];l&&d(new i((l.clientX-s.left)/s.width,1-(l.clientY-s.top)/s.height))};return window.addEventListener("touchmove",e,{passive:!0}),()=>window.removeEventListener("touchmove",e)}if(u==="tilt"){const e=t=>{const s=((t.gamma||0)+45)/90,l=((t.beta||0)+45)/90;d(new i(Math.max(0,Math.min(1,s)),Math.max(0,Math.min(1,l))))};return window.addEventListener("deviceorientation",e),()=>window.removeEventListener("deviceorientation",e)}}},[o,u]),n.useEffect(()=>{const e=()=>{const t=window.scrollY/(document.body.scrollHeight-window.innerHeight);x(Math.max(0,Math.min(1,t)))};return window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)},[]),n.useEffect(()=>{if(!w||!r.current)return;const e=new IntersectionObserver(([t])=>y(t.isIntersecting),{threshold:.1});return e.observe(r.current),()=>e.disconnect()},[w]);const H=()=>{E(!0),f==null||f()},Y=()=>{E(!1),v==null||v()},V=w&&!j?"never":b;return h.jsx(p.Provider,{value:{mouse:L,scroll:M,isMobile:o,isHovered:C},children:h.jsx("div",{ref:r,className:c,style:{width:"100%",height:"100%",...S},onMouseEnter:H,onMouseLeave:Y,children:h.jsxs(z,{frameloop:V,dpr:o?Math.min(g,1.5):g,gl:{antialias:!0,alpha:!0,powerPreference:"high-performance"},style:{width:"100%",height:"100%"},children:[h.jsx(T,{}),a]})})})}export{X as R,O as u};
