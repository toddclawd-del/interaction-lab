import{r as l,j as e,L as S}from"./index-C7OFCMki.js";import{w as I,u as M,z as F,s as A,A as L,V as z}from"./Texture-VcZ56nYh.js";import{L as P}from"./lenis-DTHSWqDp.js";const W=`uniform float uScrollSpeed;
uniform float uCurveStrength;
uniform float uCurveFrequency;

varying vec2 vUv;

#define PI 3.141592653

void main() {
  vec3 pos = position;
  vec3 worldPosition = (modelMatrix * vec4(position, 1.0)).xyz;

  // X Displacement depending on the world position Y (creates the wave)
  float xDisplacement = uCurveStrength * cos(worldPosition.y * uCurveFrequency);
  pos.x += xDisplacement;
  pos.x -= uCurveStrength; // Center the curve

  // Y Displacement according to the scroll speed (stretch effect)
  float yDisplacement = -sin(uv.x * PI) * uScrollSpeed;
  pos.y += yDisplacement;

  gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);

  // VARYINGS
  vUv = uv;
}
`,E=`precision highp float;

uniform sampler2D uTexture;
uniform vec2 uPlaneSizes;
uniform vec2 uImageSizes;
uniform float uOpacity;

varying vec2 vUv;

void main() {
  // Calculate aspect ratio correction for "object-fit: cover" effect
  vec2 ratio = vec2(
    min((uPlaneSizes.x / uPlaneSizes.y) / (uImageSizes.x / uImageSizes.y), 1.0),
    min((uPlaneSizes.y / uPlaneSizes.x) / (uImageSizes.y / uImageSizes.x), 1.0)
  );

  // Apply centered UV mapping
  vec2 uv = vec2(
    vUv.x * ratio.x + (1.0 - ratio.x) * 0.5,
    vUv.y * ratio.y + (1.0 - ratio.y) * 0.5
  );

  vec4 finalColor = texture2D(uTexture, uv);
  finalColor.a *= uOpacity;
  gl_FragColor = finalColor;
}
`,w=["https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1447752875215-b2761acb3c5d?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1433086966358-54859d0ed716?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1501785888041-af3ef285b470?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1472214103451-9374bd1c798e?w=600&h=800&fit=crop"];function C(s,n){return(s%n+n)%n}const R=l.forwardRef(({imageUrl:s,scale:n,geometry:c,position:p=[0,0,0],curveStrength:g=0,curveFrequency:a=0},v)=>{const m=l.useRef(null),o=v||m,t=L(s);l.useEffect(()=>{t&&console.log("Texture ready:",s.slice(-30))},[t,s]);const d=l.useMemo(()=>{var r,u;return t?[((r=t.image)==null?void 0:r.width)||600,((u=t.image)==null?void 0:u.height)||800]:[1,1]},[t]),f=l.useMemo(()=>({uniforms:{uTexture:{value:t},uPlaneSizes:{value:new z(n[0],n[1])},uImageSizes:{value:new z(d[0],d[1])},uScrollSpeed:{value:0},uCurveStrength:{value:g},uCurveFrequency:{value:a},uOpacity:{value:1}},vertexShader:W,fragmentShader:E,transparent:!0}),[t,n,d,g,a]);return e.jsxs("mesh",{position:p,ref:o,scale:n,children:[e.jsx("primitive",{object:c,attach:"geometry"}),e.jsx("shaderMaterial",{...f})]})});R.displayName="GLImage";function y({position:s=[0,0,0],imageSize:n,gap:c,curveStrength:p=.8,curveFrequency:g=.5,direction:a="vertical",scrollMultiplier:v=.01,lenis:m,nativeScroll:o,isMobile:t=!1}){const d=l.useRef([]),f=l.useRef(0),r=l.useMemo(()=>new F(1,1,32,32),[]),u=l.useMemo(()=>w.length*c+w.length*(a==="vertical"?n[1]:n[0]),[c,n,a]);return l.useEffect(()=>{if(t&&o||!m)return;const h=({velocity:i})=>{f.current=i};return m.on("scroll",h),()=>{m.off("scroll",h)}},[m,t,o]),A(()=>{const h=t&&o?o.current.velocity:f.current;d.current.forEach(i=>{if(!i)return;const b=i.material;b.uniforms&&(b.uniforms.uScrollSpeed.value=h*v),a==="vertical"?(i.position.y-=h*v,i.position.y=C(i.position.y+u/2,u)-u/2):(i.position.x-=h*v,i.position.x=C(i.position.x+u/2,u)-u/2)}),f.current*=.95}),e.jsx("group",{position:s,children:w.map((h,i)=>{const b=a==="vertical"?[0,i*(n[1]+c)-u/2+n[1]/2,0]:[i*(n[0]+c)-u/2+n[0]/2,0,0];return e.jsx(R,{imageUrl:h,scale:[n[0],n[1],1],geometry:r,position:b,curveStrength:p,curveFrequency:g,ref:j=>{j&&(d.current[i]=j)}},i)})})}function k({variant:s,lenis:n,nativeScroll:c,isMobileDevice:p}){const{viewport:g}=M(),a=g.width<4.5,o=Math.min(g.width,g.height)*(a?.4:.25),t=o*1.33;if(s==="single")return e.jsx(y,{imageSize:[o*(a?1.2:1),t*(a?1.2:1)],gap:t*.15,curveStrength:a?.3:.6,curveFrequency:.4,lenis:n,nativeScroll:c,isMobile:p});if(s==="dual"){const d=a?o*.55:o*.8,f=a?.8:.9;return e.jsxs(e.Fragment,{children:[e.jsx(y,{position:[-d,0,0],imageSize:[o*f,t*f],gap:t*.12,curveStrength:a?.3:.5,curveFrequency:.35,scrollMultiplier:.012,lenis:n,nativeScroll:c,isMobile:p}),e.jsx(y,{position:[d,t*.5,0],imageSize:[o*f,t*f],gap:t*.12,curveStrength:a?-.3:-.5,curveFrequency:.35,scrollMultiplier:-.01,lenis:n,nativeScroll:c,isMobile:p})]})}if(s==="triple"){if(a){const f=o*.55;return e.jsxs(e.Fragment,{children:[e.jsx(y,{position:[-f,0,0],imageSize:[o*.75,t*.75],gap:t*.1,curveStrength:.25,curveFrequency:.3,scrollMultiplier:.01,lenis:n,nativeScroll:c,isMobile:p}),e.jsx(y,{position:[f,t*.4,0],imageSize:[o*.75,t*.75],gap:t*.1,curveStrength:-.25,curveFrequency:.3,scrollMultiplier:-.008,lenis:n,nativeScroll:c,isMobile:p})]})}const d=o*1.1;return e.jsxs(e.Fragment,{children:[e.jsx(y,{position:[-d,0,-.5],imageSize:[o*.75,t*.75],gap:t*.1,curveStrength:.4,curveFrequency:.3,scrollMultiplier:.008,lenis:n,nativeScroll:c,isMobile:p}),e.jsx(y,{position:[0,t*.3,0],imageSize:[o,t],gap:t*.15,curveStrength:0,curveFrequency:0,scrollMultiplier:.015,lenis:n,nativeScroll:c,isMobile:p}),e.jsx(y,{position:[d,-t*.2,-.5],imageSize:[o*.75,t*.75],gap:t*.1,curveStrength:-.4,curveFrequency:.3,scrollMultiplier:-.01,lenis:n,nativeScroll:c,isMobile:p})]})}return e.jsx(y,{imageSize:[o*1,t*1],gap:o*.15,curveStrength:.5,curveFrequency:.3,direction:"horizontal",lenis:n,nativeScroll:c,isMobile:p})}const q=()=>typeof window>"u"?!1:/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||window.innerWidth<768,G=()=>{try{const s=document.createElement("canvas");return!!(window.WebGLRenderingContext&&(s.getContext("webgl")||s.getContext("experimental-webgl")))}catch{return!1}};function V(){const[s,n]=l.useState("dual"),c=l.useRef(null),[p,g]=l.useState(!1),[a,v]=l.useState(null),[m]=l.useState(q),[o]=l.useState(G),t=l.useRef({scroll:0,velocity:0}),d=l.useRef(0),f=l.useRef(Date.now());return o?(l.useEffect(()=>{if(m){g(!0);const r=()=>{const u=Date.now(),h=Math.max(u-f.current,1),i=window.scrollY,b=(i-d.current)/h*16;t.current={scroll:i,velocity:b*.5},d.current=i,f.current=u};return window.addEventListener("scroll",r,{passive:!0}),()=>window.removeEventListener("scroll",r)}else try{let r=function(i){u.raf(i),h=requestAnimationFrame(r)};const u=new P({duration:1.2,easing:i=>Math.min(1,1.001-Math.pow(2,-10*i)),orientation:s==="horizontal"?"horizontal":"vertical",gestureOrientation:s==="horizontal"?"horizontal":"vertical",smoothWheel:!0,infinite:!0});c.current=u,g(!0);let h;return h=requestAnimationFrame(r),()=>{cancelAnimationFrame(h),u.destroy(),c.current=null,g(!1)}}catch(r){console.error("Lenis initialization failed:",r),v("Scroll initialization failed")}},[s,m]),a?e.jsxs("div",{style:{...x.container,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"1rem"},children:[e.jsxs("p",{style:{color:"#ff6b6b",fontSize:"1.2rem"},children:["⚠️ ",a]}),e.jsx(S,{to:"/",style:{color:"#fff",textDecoration:"underline"},children:"← Back to Home"})]}):e.jsxs("div",{style:x.container,children:[!p&&e.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:e.jsx("p",{style:{color:"#666"},children:"Loading..."})}),e.jsx(S,{to:"/",style:x.backButton,children:"← Back"}),e.jsx("div",{style:x.controls,children:["single","dual","triple","horizontal"].map(r=>e.jsx("button",{onClick:()=>n(r),style:{...x.button,...s===r?x.buttonActive:{}},children:r.charAt(0).toUpperCase()+r.slice(1)},r))}),e.jsx("div",{style:x.hint,children:s==="horizontal"?"← Scroll horizontally →":"↑ Scroll to explore ↓"}),e.jsxs(I,{camera:{position:[0,0,5],fov:50},style:x.canvas,gl:{antialias:!m,alpha:!0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1},dpr:m?1:[1,2],onCreated:({gl:r})=>{console.log("WebGL context created:",r.getContext().getParameter(r.getContext().VERSION))},onError:r=>{console.error("Canvas error:",r),v("WebGL initialization failed")},children:[e.jsx("color",{attach:"background",args:["#0a0a0a"]}),e.jsx(l.Suspense,{fallback:null,children:p&&e.jsx(k,{variant:s,lenis:c.current,nativeScroll:t,isMobileDevice:m})})]}),e.jsx("div",{style:x.branding,children:"WAVY CAROUSEL"}),e.jsx("div",{style:x.scrollArea})]})):e.jsxs("div",{style:{minHeight:"100vh",background:"#0a0a0a",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"2rem",color:"#fff",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"⚠️"}),e.jsx("h2",{style:{marginBottom:"0.5rem"},children:"WebGL Not Supported"}),e.jsx("p",{style:{color:"#888",marginBottom:"1.5rem"},children:"This interaction requires WebGL which isn't available on your device/browser."}),e.jsx(S,{to:"/",style:{color:"#fff",textDecoration:"underline"},children:"← Back to Home"})]})}const x={container:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",overflow:"hidden",background:"#0a0a0a"},backButton:{position:"fixed",top:16,left:16,color:"rgba(255, 255, 255, 0.5)",textDecoration:"none",fontSize:14,fontWeight:500,zIndex:100,padding:"4px 8px",background:"rgba(0, 0, 0, 0.5)",borderRadius:4},controls:{position:"fixed",top:60,left:"50%",transform:"translateX(-50%)",display:"flex",gap:6,zIndex:100,flexWrap:"wrap",justifyContent:"center",maxWidth:"90vw"},button:{padding:"6px 12px",fontSize:11,fontWeight:500,textTransform:"uppercase",letterSpacing:"0.05em",color:"rgba(255, 255, 255, 0.5)",background:"rgba(255, 255, 255, 0.05)",borderWidth:1,borderStyle:"solid",borderColor:"rgba(255, 255, 255, 0.1)",borderRadius:4,cursor:"pointer",transition:"all 0.2s ease",whiteSpace:"nowrap"},buttonActive:{color:"#fff",background:"rgba(255, 255, 255, 0.15)",borderColor:"rgba(255, 255, 255, 0.3)"},hint:{position:"fixed",bottom:24,left:"50%",transform:"translateX(-50%)",color:"rgba(255, 255, 255, 0.3)",fontSize:12,fontWeight:400,letterSpacing:"0.1em",zIndex:100,animation:"pulse 2s ease-in-out infinite"},canvas:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},branding:{position:"fixed",top:16,right:16,color:"rgba(255, 255, 255, 0.3)",fontFamily:"monospace",fontSize:10,letterSpacing:"0.1em",pointerEvents:"none",userSelect:"none",zIndex:100},scrollArea:{position:"absolute",top:0,left:0,width:"100%",height:"500vh",pointerEvents:"none"}};export{V as WavyCarousel,V as default};
