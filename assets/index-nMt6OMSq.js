import{r as s,j as e,L as j}from"./index-D5HXmxLr.js";import{w as L,u as M,z as F,s as E,V as C}from"./react-three-fiber.esm-CDC9DQDc.js";import{L as P}from"./lenis-DTHSWqDp.js";import{u as W}from"./Texture-CJdq2c2k.js";const A=`uniform float uScrollSpeed;
uniform float uCurveStrength;
uniform float uCurveFrequency;

varying vec2 vUv;

#define PI 3.141592653

void main() {
  vec3 pos = position;
  vec3 worldPosition = (modelMatrix * vec4(position, 1.0)).xyz;

  // X Displacement depending on the world position Y (creates the wave)
  float xDisplacement = uCurveStrength * cos(worldPosition.y * uCurveFrequency);
  pos.x += xDisplacement;
  pos.x -= uCurveStrength; // Center the curve

  // Y Displacement according to the scroll speed (stretch effect)
  float yDisplacement = -sin(uv.x * PI) * uScrollSpeed;
  pos.y += yDisplacement;

  gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);

  // VARYINGS
  vUv = uv;
}
`,k=`precision highp float;

uniform sampler2D uTexture;
uniform vec2 uPlaneSizes;
uniform vec2 uImageSizes;
uniform float uOpacity;

varying vec2 vUv;

void main() {
  // Calculate aspect ratio correction for "object-fit: cover" effect
  vec2 ratio = vec2(
    min((uPlaneSizes.x / uPlaneSizes.y) / (uImageSizes.x / uImageSizes.y), 1.0),
    min((uPlaneSizes.y / uPlaneSizes.x) / (uImageSizes.y / uImageSizes.x), 1.0)
  );

  // Apply centered UV mapping
  vec2 uv = vec2(
    vUv.x * ratio.x + (1.0 - ratio.x) * 0.5,
    vUv.y * ratio.y + (1.0 - ratio.y) * 0.5
  );

  vec4 finalColor = texture2D(uTexture, uv);
  finalColor.a *= uOpacity;
  gl_FragColor = finalColor;
}
`,z=["https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1447752875215-b2761acb3c5d?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1433086966358-54859d0ed716?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1501785888041-af3ef285b470?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=600&h=800&fit=crop","https://images.unsplash.com/photo-1472214103451-9374bd1c798e?w=600&h=800&fit=crop"];function R(l,o){return(l%o+o)%o}const I=s.forwardRef(({imageUrl:l,scale:o,geometry:c,position:f=[0,0,0],curveStrength:m=0,curveFrequency:i=0},y)=>{const h=s.useRef(null),r=y||h,t=W(l);s.useEffect(()=>{t&&console.log("Texture ready:",l.slice(-30))},[t,l]);const p=s.useMemo(()=>{var x,n;return t?[((x=t.image)==null?void 0:x.width)||600,((n=t.image)==null?void 0:n.height)||800]:[1,1]},[t]),d=s.useMemo(()=>({uniforms:{uTexture:{value:t},uPlaneSizes:{value:new C(o[0],o[1])},uImageSizes:{value:new C(p[0],p[1])},uScrollSpeed:{value:0},uCurveStrength:{value:m},uCurveFrequency:{value:i},uOpacity:{value:1}},vertexShader:A,fragmentShader:k,transparent:!0}),[t,o,p,m,i]);return e.jsxs("mesh",{position:f,ref:r,scale:o,children:[e.jsx("primitive",{object:c,attach:"geometry"}),e.jsx("shaderMaterial",{...d})]})});I.displayName="GLImage";function w({position:l=[0,0,0],imageSize:o,gap:c,curveStrength:f=.8,curveFrequency:m=.5,direction:i="vertical",scrollMultiplier:y=.01,lenis:h,nativeScroll:r,isMobile:t=!1}){const p=s.useRef([]),d=s.useRef(0),x=s.useMemo(()=>new F(1,1,32,32),[]),n=s.useMemo(()=>z.length*c+z.length*(i==="vertical"?o[1]:o[0]),[c,o,i]);s.useEffect(()=>{if(t&&r||!h)return;const u=({velocity:a})=>{d.current=a};return h.on("scroll",u),()=>{h.off("scroll",u)}},[h,t,r]);const g=s.useRef(0);return E(()=>{const u=t&&r?r.current.velocity:d.current;g.current++,g.current%60===1&&console.log("Frame update:",{isMobile:t,velocity:u.toFixed(3),imageCount:p.current.length}),p.current.forEach(a=>{if(!a)return;const b=a.material;b.uniforms&&(b.uniforms.uScrollSpeed.value=u*y),i==="vertical"?(a.position.y-=u*y,a.position.y=R(a.position.y+n/2,n)-n/2):(a.position.x-=u*y,a.position.x=R(a.position.x+n/2,n)-n/2)}),d.current*=.95}),e.jsx("group",{position:l,children:z.map((u,a)=>{const b=i==="vertical"?[0,a*(o[1]+c)-n/2+o[1]/2,0]:[a*(o[0]+c)-n/2+o[0]/2,0,0];return e.jsx(I,{imageUrl:u,scale:[o[0],o[1],1],geometry:x,position:b,curveStrength:f,curveFrequency:m,ref:S=>{S&&(p.current[a]=S)}},a)})})}function q({variant:l,lenis:o,nativeScroll:c,isMobileDevice:f}){const{viewport:m}=M(),i=m.width<4.5,r=Math.min(m.width,m.height)*(i?.4:.25),t=r*1.33;if(l==="single")return e.jsx(w,{imageSize:[r*(i?1.2:1),t*(i?1.2:1)],gap:t*.15,curveStrength:i?.3:.6,curveFrequency:.4,lenis:o,nativeScroll:c,isMobile:f});if(l==="dual"){const p=i?r*.55:r*.8,d=i?.8:.9;return e.jsxs(e.Fragment,{children:[e.jsx(w,{position:[-p,0,0],imageSize:[r*d,t*d],gap:t*.12,curveStrength:i?.3:.5,curveFrequency:.35,scrollMultiplier:.012,lenis:o,nativeScroll:c,isMobile:f}),e.jsx(w,{position:[p,t*.5,0],imageSize:[r*d,t*d],gap:t*.12,curveStrength:i?-.3:-.5,curveFrequency:.35,scrollMultiplier:-.01,lenis:o,nativeScroll:c,isMobile:f})]})}if(l==="triple"){if(i){const d=r*.55;return e.jsxs(e.Fragment,{children:[e.jsx(w,{position:[-d,0,0],imageSize:[r*.75,t*.75],gap:t*.1,curveStrength:.25,curveFrequency:.3,scrollMultiplier:.01,lenis:o,nativeScroll:c,isMobile:f}),e.jsx(w,{position:[d,t*.4,0],imageSize:[r*.75,t*.75],gap:t*.1,curveStrength:-.25,curveFrequency:.3,scrollMultiplier:-.008,lenis:o,nativeScroll:c,isMobile:f})]})}const p=r*1.1;return e.jsxs(e.Fragment,{children:[e.jsx(w,{position:[-p,0,-.5],imageSize:[r*.75,t*.75],gap:t*.1,curveStrength:.4,curveFrequency:.3,scrollMultiplier:.008,lenis:o,nativeScroll:c,isMobile:f}),e.jsx(w,{position:[0,t*.3,0],imageSize:[r,t],gap:t*.15,curveStrength:0,curveFrequency:0,scrollMultiplier:.015,lenis:o,nativeScroll:c,isMobile:f}),e.jsx(w,{position:[p,-t*.2,-.5],imageSize:[r*.75,t*.75],gap:t*.1,curveStrength:-.4,curveFrequency:.3,scrollMultiplier:-.01,lenis:o,nativeScroll:c,isMobile:f})]})}return e.jsx(w,{imageSize:[r*1,t*1],gap:r*.15,curveStrength:.5,curveFrequency:.3,direction:"horizontal",lenis:o,nativeScroll:c,isMobile:f})}const G=()=>typeof window>"u"?!1:/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||window.innerWidth<768,B=()=>{try{const l=document.createElement("canvas");return!!(window.WebGLRenderingContext&&(l.getContext("webgl")||l.getContext("experimental-webgl")))}catch{return!1}};function H(){const[l,o]=s.useState("dual"),c=s.useRef(null),[f,m]=s.useState(!1),[i,y]=s.useState(null),[h]=s.useState(G),[r]=s.useState(B),t=s.useRef({scroll:0,velocity:0}),p=s.useRef(0),d=s.useRef(Date.now());if(!r)return e.jsxs("div",{style:{minHeight:"100vh",background:"#0a0a0a",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"2rem",color:"#fff",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"⚠️"}),e.jsx("h2",{style:{marginBottom:"0.5rem"},children:"WebGL Not Supported"}),e.jsx("p",{style:{color:"#888",marginBottom:"1.5rem"},children:"This interaction requires WebGL which isn't available on your device/browser."}),e.jsx(j,{to:"/",style:{color:"#fff",textDecoration:"underline"},children:"← Back to Home"})]});const x=l==="horizontal";return s.useEffect(()=>{if(h){m(!0);let n=0;const g=()=>{const u=Date.now(),a=Math.max(u-d.current,1),b=x?window.scrollX:window.scrollY,S=(b-p.current)/a*16;t.current={scroll:b,velocity:S*.5},n<5&&(console.log("Mobile scroll:",{scroll:b,velocity:S.toFixed(2)}),n++),p.current=b,d.current=u};return window.addEventListener("scroll",g,{passive:!0}),()=>window.removeEventListener("scroll",g)}else try{let n=function(a){g.raf(a),u=requestAnimationFrame(n)};const g=new P({duration:1.2,easing:a=>Math.min(1,1.001-Math.pow(2,-10*a)),orientation:x?"horizontal":"vertical",gestureOrientation:x?"horizontal":"vertical",smoothWheel:!0,infinite:!0});c.current=g,m(!0);let u;return u=requestAnimationFrame(n),()=>{cancelAnimationFrame(u),g.destroy(),c.current=null,m(!1)}}catch(n){console.error("Lenis initialization failed:",n),y("Scroll initialization failed")}},[x,h]),i?e.jsxs("div",{style:{...v.container,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"1rem"},children:[e.jsxs("p",{style:{color:"#ff6b6b",fontSize:"1.2rem"},children:["⚠️ ",i]}),e.jsx(j,{to:"/",style:{color:"#fff",textDecoration:"underline"},children:"← Back to Home"})]}):e.jsxs("div",{style:v.container,children:[!f&&e.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:e.jsx("p",{style:{color:"#666"},children:"Loading..."})}),e.jsx(j,{to:"/",style:v.backButton,children:"← Back"}),e.jsx("div",{style:v.controls,children:["single","dual","triple","horizontal"].map(n=>e.jsx("button",{onClick:()=>o(n),style:{...v.button,...l===n?v.buttonActive:{}},children:n.charAt(0).toUpperCase()+n.slice(1)},n))}),e.jsx("div",{style:v.hint,children:l==="horizontal"?"← Scroll horizontally →":"↑ Scroll to explore ↓"}),e.jsxs(L,{camera:{position:[0,0,5],fov:50},style:v.canvas,gl:{antialias:!h,alpha:!0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!0},dpr:h?1:[1,2],onCreated:({gl:n})=>{console.log("WebGL context created:",n.getContext().getParameter(n.getContext().VERSION));const g=n.domElement;g.addEventListener("webglcontextlost",u=>{u.preventDefault(),console.warn("WebGL context lost")}),g.addEventListener("webglcontextrestored",()=>{console.log("WebGL context restored")})},onError:n=>{console.error("Canvas error:",n),y("WebGL initialization failed")},children:[e.jsx("color",{attach:"background",args:["#0a0a0a"]}),e.jsx(s.Suspense,{fallback:null,children:f&&e.jsx(q,{variant:l,lenis:c.current,nativeScroll:t,isMobileDevice:h})})]}),e.jsx("div",{style:v.branding,children:"WAVY CAROUSEL"}),e.jsx("div",{style:{...v.scrollArea,...x?{height:"100vh",width:"500vw",display:"flex"}:{}}})]})}const v={container:{position:"relative",width:"100vw",minHeight:"100vh",background:"#0a0a0a"},backButton:{position:"fixed",top:16,left:16,color:"rgba(255, 255, 255, 0.5)",textDecoration:"none",fontSize:14,fontWeight:500,zIndex:100,padding:"4px 8px",background:"rgba(0, 0, 0, 0.5)",borderRadius:4},controls:{position:"fixed",top:60,left:"50%",transform:"translateX(-50%)",display:"flex",gap:6,zIndex:100,flexWrap:"wrap",justifyContent:"center",maxWidth:"90vw"},button:{padding:"6px 12px",fontSize:11,fontWeight:500,textTransform:"uppercase",letterSpacing:"0.05em",color:"rgba(255, 255, 255, 0.5)",background:"rgba(255, 255, 255, 0.05)",borderWidth:1,borderStyle:"solid",borderColor:"rgba(255, 255, 255, 0.1)",borderRadius:4,cursor:"pointer",transition:"all 0.2s ease",whiteSpace:"nowrap"},buttonActive:{color:"#fff",background:"rgba(255, 255, 255, 0.15)",borderColor:"rgba(255, 255, 255, 0.3)"},hint:{position:"fixed",bottom:24,left:"50%",transform:"translateX(-50%)",color:"rgba(255, 255, 255, 0.3)",fontSize:12,fontWeight:400,letterSpacing:"0.1em",zIndex:100,animation:"pulse 2s ease-in-out infinite"},canvas:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:1},branding:{position:"fixed",top:16,right:16,color:"rgba(255, 255, 255, 0.3)",fontFamily:"monospace",fontSize:10,letterSpacing:"0.1em",pointerEvents:"none",userSelect:"none",zIndex:100},scrollArea:{position:"relative",width:"100%",height:"500vh",pointerEvents:"auto"}};export{H as WavyCarousel,H as default};
